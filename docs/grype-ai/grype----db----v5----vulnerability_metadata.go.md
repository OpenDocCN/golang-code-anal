# `grype\grype\db\v5\vulnerability_metadata.go`

```go
// 定义 VulnerabilityMetadata 结构体，表示与包到漏洞匹配无关的所有漏洞数据
type VulnerabilityMetadata struct {
    ID           string   `json:"id"`            // 漏洞或咨询的标识符
    Namespace    string   `json:"namespace"`     // 此条目在其中有效的命名空间
    DataSource   string   `json:"data_source"`   // 数据来源的 URL
    RecordSource string   `json:"record_source"` // 漏洞信息的来源（相对于企业 feedgroup 中的直接上游）
    Severity     string   `json:"severity"`      // 漏洞的严重程度（目前由上游来源定义有效值）
    URLs         []string `json:"urls"`          // 获取有关漏洞或咨询的更多信息的 URL
    Description  string   `json:"description"`   // 漏洞描述
    Cvss         []Cvss   `json:"cvss"`          // 公共漏洞评分系统值
}

// 定义 Cvss 结构体，包含漏洞的部分公共漏洞评分系统字段
type Cvss struct {
    // VendorMetadata 捕获供应商在提供 CVSS 信息时有时可能包含的非标准 CVSS 字段。此供应商特定的元数据类型允许捕获该数据以持久化到数据库中
    VendorMetadata interface{} `json:"vendor_metadata"`
    Metrics        CvssMetrics `json:"metrics"`
    Vector         string      `json:"vector"`  // 用于确定分数的度量值的文本表示
    Version        string      `json:"version"` // CVSS 规范的版本，例如 2.0、3.0 或 3.1
    Source         string      `json:"source"`  // 标识提供分数的组织
    Type           string      `json:"type"`    // 源是否为“primary”或“secondary”源
}
// CvssMetrics是构成CVSS分数的定量值。
type CvssMetrics struct {
    // BaseScore范围从0到10，定义了与漏洞严重性相关的内在特性。
    BaseScore float64 `json:"base_score"`
    // ExploitabilityScore是一个指针，避免默认值为0。
    // 它指示攻击者可能利用漏洞的难易程度。
    ExploitabilityScore *float64 `json:"exploitability_score"`
    // ImpactScore表示利用漏洞相对于机密性、完整性和可用性妥协的影响。
    // 这是一个可选参数，所以它是一个指针而不是常规字段。
    ImpactScore *float64 `json:"impact_score"`
}

// NewCvssMetrics创建一个CvssMetrics对象。
func NewCvssMetrics(baseScore, exploitabilityScore, impactScore float64) CvssMetrics {
    return CvssMetrics{
        BaseScore:           baseScore,
        ExploitabilityScore: &exploitabilityScore,
        ImpactScore:         &impactScore,
    }
}

// Equal方法用于比较两个VulnerabilityMetadata对象是否相等。
func (v *VulnerabilityMetadata) Equal(vv VulnerabilityMetadata) bool {
    equal := v.ID == vv.ID &&
        v.Namespace == vv.Namespace &&
        v.DataSource == vv.DataSource &&
        v.RecordSource == vv.RecordSource &&
        v.Severity == vv.Severity &&
        v.Description == vv.Description &&
        len(v.URLs) == len(vv.URLs) &&
        len(v.Cvss) == len(vv.Cvss)

    if !equal {
        return false
    }
    for idx, cpe := range v.URLs {
        if cpe != vv.URLs[idx] {
            return false
        }
    }
    for idx, item := range v.Cvss {
        if !reflect.DeepEqual(item, vv.Cvss[idx]) {
            return false
        }
    }

    return true
}
```