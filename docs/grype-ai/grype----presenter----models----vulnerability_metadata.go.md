# `grype\grype\presenter\models\vulnerability_metadata.go`

```
// 导入 grype/vulnerability 包
import "github.com/anchore/grype/grype/vulnerability"

// 定义 VulnerabilityMetadata 结构体
type VulnerabilityMetadata struct {
    ID          string   `json:"id"` // 漏洞 ID
    DataSource  string   `json:"dataSource"` // 数据源
    Namespace   string   `json:"namespace,omitempty"` // 命名空间
    Severity    string   `json:"severity,omitempty"` // 严重程度
    URLs        []string `json:"urls"` // 相关链接
    Description string   `json:"description,omitempty"` // 描述
    Cvss        []Cvss   `json:"cvss"` // CVSS 评分
}

// 创建新的 VulnerabilityMetadata 对象
func NewVulnerabilityMetadata(id, namespace string, metadata *vulnerability.Metadata) VulnerabilityMetadata {
    // 如果 metadata 为空，则返回只包含 ID 和 Namespace 的 VulnerabilityMetadata 对象
    if metadata == nil {
        return VulnerabilityMetadata{
            ID:        id,
            Namespace: namespace,
        }
// 如果metadata.URLs为空，则初始化一个空的字符串数组
urls := metadata.URLs
if urls == nil {
    urls = make([]string, 0)
}

// 返回VulnerabilityMetadata结构体，包括ID、DataSource、Namespace、Severity、URLs、Description和Cvss字段
return VulnerabilityMetadata{
    ID:          id,
    DataSource:  metadata.DataSource,
    Namespace:   metadata.Namespace,
    Severity:    metadata.Severity,
    URLs:        urls,
    Description: metadata.Description,
    Cvss:        NewCVSS(metadata),
}
}

// 返回用于漏洞严重性排序的分数
func SeverityScore(severtiy string) int {
# 根据传入的严重性级别返回相应的数值
switch severtiy:
    # 如果严重性级别为"Unknown"，返回0
    case "Unknown":
        return 0
    # 如果严重性级别为"Negligible"，返回1
    case "Negligible":
        return 1
    # 如果严重性级别为"Low"，返回2
    case "Low":
        return 2
    # 如果严重性级别为"Medium"，返回3
    case "Medium":
        return 3
    # 如果严重性级别为"High"，返回4
    case "High":
        return 4
    # 如果严重性级别为"Critical"，返回5
    case "Critical":
        return 5
    # 如果严重性级别为其他值，返回0
    default:
        return 0
```