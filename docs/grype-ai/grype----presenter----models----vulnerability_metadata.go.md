# `grype\grype\presenter\models\vulnerability_metadata.go`

```
package models

import "github.com/anchore/grype/grype/vulnerability"

type VulnerabilityMetadata struct {
    ID          string   `json:"id"`  // 漏洞的唯一标识符
    DataSource  string   `json:"dataSource"`  // 数据源
    Namespace   string   `json:"namespace,omitempty"`  // 命名空间
    Severity    string   `json:"severity,omitempty"`  // 严重程度
    URLs        []string `json:"urls"`  // 相关链接
    Description string   `json:"description,omitempty"`  // 描述
    Cvss        []Cvss   `json:"cvss"`  // CVSS 评分
}

func NewVulnerabilityMetadata(id, namespace string, metadata *vulnerability.Metadata) VulnerabilityMetadata {
    if metadata == nil {
        return VulnerabilityMetadata{
            ID:        id,  // 设置漏洞的唯一标识符
            Namespace: namespace,  // 设置命名空间
        }
    }

    urls := metadata.URLs  // 获取元数据中的链接
    if urls == nil {
        urls = make([]string, 0)  // 如果链接为空，则创建一个空的字符串数组
    }

    return VulnerabilityMetadata{
        ID:          id,  // 设置漏洞的唯一标识符
        DataSource:  metadata.DataSource,  // 设置数据源
        Namespace:   metadata.Namespace,  // 设置命名空间
        Severity:    metadata.Severity,  // 设置严重程度
        URLs:        urls,  // 设置链接
        Description: metadata.Description,  // 设置描述
        Cvss:        NewCVSS(metadata),  // 设置 CVSS 评分
    }
}

// returns severtiy score for presenter sorting purposes
func SeverityScore(severtiy string) int {
    switch severtiy {
    case "Unknown":
        return 0  // 未知严重程度的分数为 0
    case "Negligible":
        return 1  // 微不足道的严重程度的分数为 1
    case "Low":
        return 2  // 低严重程度的分数为 2
    case "Medium":
        return 3  // 中等严重程度的分数为 3
    case "High":
        return 4  // 高严重程度的分数为 4
    case "Critical":
        return 5  // 严重严重程度的分数为 5
    default:
        return 0  // 默认情况下，返回 0
    }
}
```