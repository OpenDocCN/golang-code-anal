# `grype\grype\vulnerability\metadata.go`

```
package vulnerability

import (
    grypeDB "github.com/anchore/grype/grype/db/v5"
)

type Metadata struct {
    ID          string          // 漏洞ID
    DataSource  string          // 数据源
    Namespace   string          // 命名空间
    Severity    string          // 严重程度
    URLs        []string        // 相关URL
    Description string          // 描述
    Cvss        []Cvss          // CVSS评分
}

type Cvss struct {
    Source         string        // 来源
    Type           string        // 类型
    Version        string        // 版本
    Vector         string        // 向量
    Metrics        CvssMetrics   // CVSS评分指标
    VendorMetadata interface{}   // 厂商元数据
}

type CvssMetrics struct {
    BaseScore           float64   // 基础分数
    ExploitabilityScore *float64  // 可利用性分数
    ImpactScore         *float64  // 影响分数
}

func NewMetadata(m *grypeDB.VulnerabilityMetadata) (*Metadata, error) {
    if m == nil {
        return nil, nil
    }
    return &Metadata{
        ID:          m.ID,
        DataSource:  m.DataSource,
        Namespace:   m.Namespace,
        Severity:    m.Severity,
        URLs:        m.URLs,
        Description: m.Description,
        Cvss:        NewCvss(m.Cvss),  // 创建CVSS评分
    }, nil
}

func NewCvss(m []grypeDB.Cvss) []Cvss {
    //nolint:prealloc
    var cvss []Cvss
    for _, score := range m {
        cvss = append(cvss, Cvss{
            Source:  score.Source,
            Type:    score.Type,
            Version: score.Version,
            Vector:  score.Vector,
            Metrics: CvssMetrics{
                BaseScore:           score.Metrics.BaseScore,
                ExploitabilityScore: score.Metrics.ExploitabilityScore,
                ImpactScore:         score.Metrics.ImpactScore,
            },
            VendorMetadata: score.VendorMetadata,
        })
    }
    return cvss
}

func NewCvssMetrics(baseScore, exploitabilityScore, impactScore float64) CvssMetrics {
    return CvssMetrics{
        BaseScore:           baseScore,
        ExploitabilityScore: &exploitabilityScore,
        ImpactScore:         &impactScore,
    }
}
```