# `grype\grype\vulnerability\metadata.go`

```
// 导入 anchore/grype/grype/db/v5 包
import (
	grypeDB "github.com/anchore/grype/grype/db/v5"
)

// Metadata 结构体定义
type Metadata struct {
	ID          string      // 漏洞 ID
	DataSource  string      // 数据源
	Namespace   string      // 命名空间
	Severity    string      // 严重程度
	URLs        []string    // 相关链接
	Description string      // 描述
	Cvss        []Cvss      // Cvss 评分
}

// Cvss 结构体定义
type Cvss struct {
	Source         string    // 来源
	Type           string    // 类型
	Version        string    // 版本
}
// 定义结构体 Metadata，包含 Vector 字段（类型为 string）、Metrics 字段（类型为 CvssMetrics）、VendorMetadata 字段（类型为任意接口）
type Metadata struct {
	Vector         string
	Metrics        CvssMetrics
	VendorMetadata interface{}
}

// 定义结构体 CvssMetrics，包含 BaseScore 字段（类型为 float64）、ExploitabilityScore 字段（类型为指向 float64 类型的指针）、ImpactScore 字段（类型为指向 float64 类型的指针）
type CvssMetrics struct {
	BaseScore           float64
	ExploitabilityScore *float64
	ImpactScore         *float64
}

// 定义函数 NewMetadata，接收一个 grypeDB.VulnerabilityMetadata 类型的指针作为参数，返回一个 Metadata 类型的指针和一个 error 类型的值
func NewMetadata(m *grypeDB.VulnerabilityMetadata) (*Metadata, error) {
	// 如果参数 m 为 nil，则返回 nil 和 nil
	if m == nil {
		return nil, nil
	}
	// 返回一个 Metadata 类型的指针，包含参数 m 的各个字段值
	return &Metadata{
		ID:          m.ID,
		DataSource:  m.DataSource,
		Namespace:   m.Namespace,
		Severity:    m.Severity,
		// 其他字段的赋值省略
	}, nil // 返回一个空的 error 值
}
		URLs:        m.URLs,  // 从输入参数 m 中获取 URLs 字段的值
		Description: m.Description,  // 从输入参数 m 中获取 Description 字段的值
		Cvss:        NewCvss(m.Cvss),  // 调用 NewCvss 函数处理输入参数 m 中的 Cvss 字段，并赋值给 Cvss 字段
	}, nil  // 返回结构体和空指针

func NewCvss(m []grypeDB.Cvss) []Cvss {
	//nolint:prealloc  // 禁止预分配内存
	var cvss []Cvss  // 声明一个 Cvss 类型的切片
	for _, score := range m {  // 遍历输入参数 m 中的每个元素
		cvss = append(cvss, Cvss{  // 将处理后的数据追加到 cvss 切片中
			Source:  score.Source,  // 从输入参数 score 中获取 Source 字段的值
			Type:    score.Type,  // 从输入参数 score 中获取 Type 字段的值
			Version: score.Version,  // 从输入参数 score 中获取 Version 字段的值
			Vector:  score.Vector,  // 从输入参数 score 中获取 Vector 字段的值
			Metrics: CvssMetrics{  // 构造一个 CvssMetrics 结构体
				BaseScore:           score.Metrics.BaseScore,  // 从输入参数 score 中获取 Metrics 结构体中的 BaseScore 字段的值
				ExploitabilityScore: score.Metrics.ExploitabilityScore,  // 从输入参数 score 中获取 Metrics 结构体中的 ExploitabilityScore 字段的值
				ImpactScore:         score.Metrics.ImpactScore,  // 从输入参数 score 中获取 Metrics 结构体中的 ImpactScore 字段的值
			},
# 创建一个新的CvssMetrics对象，包括基本分数、可利用性分数和影响分数
func NewCvssMetrics(baseScore, exploitabilityScore, impactScore float64) CvssMetrics {
    # 返回一个包含基本分数、可利用性分数和影响分数的CvssMetrics对象
    return CvssMetrics{
        BaseScore:           baseScore,  # 设置基本分数
        ExploitabilityScore: &exploitabilityScore,  # 设置可利用性分数的指针
        ImpactScore:         &impactScore,  # 设置影响分数的指针
    }
}
```